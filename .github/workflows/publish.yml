name: Build and publish docs

on: [push]

jobs:
  publish:
    if: "!contains(github.event.head_commit.message, 'skip_ci')"

    runs-on: ubuntu-latest

    steps:
      - name: Checkout PostREISE
        uses: actions/checkout@v2
        with:
          repository: Breakthrough-Energy/PostREISE
          token: ${{ secrets.CI_TOKEN_CLONE_REPO }}
          path: PostREISE

      - name: Checkout PowerSimData
        uses: actions/checkout@v2
        with:
          repository: Breakthrough-Energy/PowerSimData
          token: ${{ secrets.CI_TOKEN_CLONE_REPO }}
          path: PowerSimData

      - name: Checkout PreREISE
        uses: actions/checkout@v2
        with:
          repository: Breakthrough-Energy/PreREISE
          token: ${{ secrets.CI_TOKEN_CLONE_REPO }}
          path: PreREISE

      - name: Set up Python 3.x
        uses: actions/setup-python@v2
        with:
            python-version: '3.x'

      - name: Display Python version
        run: python -c "import sys; print(sys.version)"

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip tox

      - name: Build docs
        run: tox
