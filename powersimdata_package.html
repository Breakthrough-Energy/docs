
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PowerSimData &#8212; documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PreREISE" href="prereise_package.html" />
    <link rel="prev" title="Working with Git" href="user/git_guide.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p><a class="reference external" href="https://github.com/psf/black"><img alt="Code style: black" src="https://img.shields.io/badge/code%20style-black-000000.svg" /></a>
<img alt="Tests" src="https://github.com/Breakthrough-Energy/PowerSimData/workflows/Pytest/badge.svg" /></p>
<div class="section" id="powersimdata">
<h1>PowerSimData<a class="headerlink" href="#powersimdata" title="Permalink to this headline">¶</a></h1>
<p>This package has been written in order to carry out power flow study in the U.S. electrical grid. This framework allows the user to easily build extensive scenarios.</p>
<p>PowerSimData is part of a set of packages representing Breakthrough Energy’s power system model. More information regarding the installation of the model as well as the contribution guide can be found <a class="reference external" href="https://breakthrough-energy.github.io/docs/">here</a>.</p>
<div class="section" id="setup-install">
<h2>1. Setup/Install<a class="headerlink" href="#setup-install" title="Permalink to this headline">¶</a></h2>
<p>Here are the instructions to install the <strong>PowerSimData</strong> package. We strongly recommend that you pick one of the following options.</p>
<div class="section" id="a-using-pipenv">
<h3>A. Using pipenv<a class="headerlink" href="#a-using-pipenv" title="Permalink to this headline">¶</a></h3>
<p>If not already done, install <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> (see their <a class="reference external" href="https://pipenv.pypa.io/en/latest/">webpage</a>) and run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pipenv sync
pipenv shell
</pre></div>
</div>
<p>in the root folder of the package. The first command will create a virtual environment and install the dependencies. The second command will activate the environment.</p>
</div>
<div class="section" id="b-using-the-requirements-txt-file">
<h3>B. Using the <em><strong>requirements.txt</strong></em> file<a class="headerlink" href="#b-using-the-requirements-txt-file" title="Permalink to this headline">¶</a></h3>
<p>First create an environment using <code class="docutils literal notranslate"><span class="pre">venv</span></code> (more details <a class="reference external" href="https://docs.python.org/3/library/venv.html">here</a>). Note that <code class="docutils literal notranslate"><span class="pre">venv</span></code> is included in the Python standard library and requires no additional installation. Then, activate your environment and run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -r requirements.txt
</pre></div>
</div>
<p>in the root folder of the package.</p>
</div>
<div class="section" id="c-path">
<h3>C. Path<a class="headerlink" href="#c-path" title="Permalink to this headline">¶</a></h3>
<p>Whatever method you choose, if you wish to access the modules located in <strong>PowerSimData</strong> from anywhere on your machine, do:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install .
</pre></div>
</div>
<p>in the root folder of your package or alternatively, setup the <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> global variable to include the folder into which you have cloned the repository.</p>
</div>
</div>
<div class="section" id="scenario-framework">
<h2>2. Scenario Framework<a class="headerlink" href="#scenario-framework" title="Permalink to this headline">¶</a></h2>
<p>A scenario is defined by the following objects:</p>
<ul class="simple">
<li><p><strong>The power grid</strong>, an interconnected network delivering electricity from producers to load buses and consisting of:</p>
<ul>
<li><p>Thermal (coal, natural gas, etc.) and renewable generators (wind turbines, etc.) that produce electrical power</p></li>
<li><p>Substations that change voltage levels (from high to low, or the reverse)</p></li>
<li><p>Transmission lines that carry power from one place to the other (between two substations, between a substation and load bus, between a generator bus and a substation, etc.) - Both, high voltage AC and DC lines are used in our model</p></li>
<li><p>Generator cost curve that specifies the cost as a function of power generated ($/MWh) - These are determined by fuel cost and generator efficiency</p></li>
</ul>
</li>
<li><p><strong>Time series</strong> for renewable generators and demand - These profiles are calculated in the <a class="reference external" href="https://github.com/Breakthrough-Energy/PreREISE">PreREISE</a> package and the list of profiles generated can be consulted through the following links: <a class="reference external" href="https://github.com/Breakthrough-Energy/PreREISE/tree/develop/prereise/gather/demanddata">demand</a>, <a class="reference external" href="https://github.com/Breakthrough-Energy/PreREISE/tree/develop/prereise/gather/hydrodata">hydro</a>, <a class="reference external" href="https://github.com/Breakthrough-Energy/PreREISE/tree/develop/prereise/gather/solardata">solar</a> and <a class="reference external" href="https://github.com/Breakthrough-Energy/PreREISE/tree/develop/prereise/gather/winddata">wind</a>.</p>
<ul>
<li><p>Profile for the renewable generators consists of hourly power output</p></li>
<li><p>Load profile gives the hourly demand (MW) in various load zones, which are geographic entities such as a state or a portion of a state</p></li>
</ul>
</li>
<li><p><strong>Change table</strong> used to alter the grid and profiles. To illustrate:</p>
<ul>
<li><p>Generators and transmission lines (AC and DC) capacity can be scaled up and down</p></li>
<li><p>Storage units, generators and transmission lines can be added</p></li>
</ul>
</li>
<li><p><strong>Simulation parameters</strong> such as the start and end date along with the duration of the intervals - The simulation engine can also be selected in the building phase of the scenario</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> class handles the following tasks:</p>
<ul class="simple">
<li><p>Build a scenario (<strong>create</strong> state)</p></li>
<li><p>Launch the scenario and extract the output data (<strong>execute</strong> state)</p></li>
<li><p>Retrieve the output data (<strong>analyze</strong> state)</p></li>
<li><p>Delete a scenario (<strong>delete</strong> state)</p></li>
<li><p>Move a scenario to a backup disk (<strong>move</strong> state)</p></li>
</ul>
<p>When a <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> class is instantiated, its state is set either to <strong>create</strong>, <strong>execute</strong> or <strong>analyze</strong>. The initial state of the <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> object is set in the constructor of the class. Only one argument is required to create a <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> object:</p>
<ul class="simple">
<li><p>An empty string instantiates the <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> class in the <strong>create</strong> state. A scenario can then be built</p></li>
<li><p>If a valid scenario identification number (<code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code>) or name (<code class="docutils literal notranslate"><span class="pre">str</span></code>) is provided:</p>
<ul>
<li><p>If the scenario has been ran and its output data have been extracted, the state will be set to <strong>analyze</strong></p></li>
<li><p>If the scenario has only been created or ran but not extracted the state will be then set to <strong>execute</strong></p></li>
</ul>
</li>
</ul>
<p>Note that instantiating a <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> object with a string that doesn’t match any existing scenarios identification number or name will result in a printout of the list of existing scenarios and their information.</p>
<div class="section" id="a-retrieving-scenario-output-data">
<h3>A. Retrieving Scenario Output Data<a class="headerlink" href="#a-retrieving-scenario-output-data" title="Permalink to this headline">¶</a></h3>
<p>When the <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> object is in the <strong>analyze</strong> state, the user can access various scenario information and data. The following code snippet lists the methods implemented to do so.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">powersimdata.scenario.scenario</span> <span class="kn">import</span> <span class="n">Scenario</span>

<span class="n">scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">(</span><span class="mi">600</span><span class="p">)</span>
<span class="c1"># print name of Scenario object state</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># print scenario information</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">print_scenario_info</span><span class="p">()</span>

<span class="c1"># get change table</span>
<span class="n">ct</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_ct</span><span class="p">()</span>
<span class="c1"># get grid</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_grid</span><span class="p">()</span>

<span class="c1"># get demand profile</span>
<span class="n">demand</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_demand</span><span class="p">()</span>
<span class="c1"># get hydro profile</span>
<span class="n">hydro</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_hydro</span><span class="p">()</span>
<span class="c1"># get solar profile</span>
<span class="n">solar</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_solar</span><span class="p">()</span>
<span class="c1"># get wind profile</span>
<span class="n">wind</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_wind</span><span class="p">()</span>

<span class="c1"># get generation profile for generators</span>
<span class="n">pg</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_pg</span><span class="p">()</span>
<span class="c1"># get generation profile for storage units (if present in scenario)</span>
<span class="n">pg_storage</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_storage_pg</span><span class="p">()</span>
<span class="c1"># get energy state of charge of storage units (if present in scenario)</span>
<span class="n">e_storage</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_storage_e</span><span class="p">()</span>
<span class="c1"># get power flow profile for AC lines</span>
<span class="n">pf_ac</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_pf</span><span class="p">()</span>
<span class="c1"># get power flow profile for DC lines</span>
<span class="n">pf_dc</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_dcline_pf</span><span class="p">()</span>
<span class="c1"># get locational marginal price profile for each bus</span>
<span class="n">lmp</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_lmp</span><span class="p">()</span>
<span class="c1"># get congestion (upper power flow limit) profile for AC lines</span>
<span class="n">congu</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_congu</span><span class="p">()</span>
<span class="c1"># get congestion (lower power flow limit) profile for AC lines</span>
<span class="n">congl</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_congl</span><span class="p">()</span>
<span class="c1"># get time averaged congestion (lower and power flow limits) for AC lines</span>
<span class="n">avg_cong</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_averaged_cong</span><span class="p">()</span>
<span class="c1"># get load shed profile for each load bus</span>
<span class="n">load_shed</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_load_shed</span><span class="p">()</span>
</pre></div>
</div>
<p>If generators or AC/DC lines have been scaled or added to the grid, and/or if the demand in one or multiple load zones has been scaled for this scenario then the change table will enclose these changes and the retrieved grid and profiles will be modified accordingly. Note that the analysis of the scenario using the output data is done in the <a class="reference external" href="https://github.com/Breakthrough-Energy/PostREISE">PostREISE</a> package.</p>
</div>
<div class="section" id="b-creating-a-scenario">
<h3>B. Creating a Scenario<a class="headerlink" href="#b-creating-a-scenario" title="Permalink to this headline">¶</a></h3>
<p>A scenario can be created using few lines of code. This is illustrated below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">powersimdata.scenario.scenario</span> <span class="kn">import</span> <span class="n">Scenario</span>

<span class="n">scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># print name of Scenario object state</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># Start building a scenario</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">set_builder</span><span class="p">([</span><span class="s2">&quot;Western&quot;</span><span class="p">])</span>

<span class="c1"># set plan and scenario names</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;dummy&quot;</span><span class="p">)</span>
<span class="c1"># set start date, end date and interval</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">set_time</span><span class="p">(</span><span class="s2">&quot;2016-08-01 00:00:00&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;2016-08-31 23:00:00&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;24H&quot;</span><span class="p">)</span>
<span class="c1"># set demand profile version</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">set_base_profile</span><span class="p">(</span><span class="s2">&quot;demand&quot;</span><span class="p">,</span> <span class="s2">&quot;v4&quot;</span><span class="p">)</span>
<span class="c1"># set hydro profile version</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">set_base_profile</span><span class="p">(</span><span class="s2">&quot;hydro&quot;</span><span class="p">,</span> <span class="s2">&quot;v2&quot;</span><span class="p">)</span>
<span class="c1"># set solar profile version</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">set_base_profile</span><span class="p">(</span><span class="s2">&quot;solar&quot;</span><span class="p">,</span> <span class="s2">&quot;v4.1&quot;</span><span class="p">)</span>
<span class="c1"># set wind profile version</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">set_base_profile</span><span class="p">(</span><span class="s2">&quot;wind&quot;</span><span class="p">,</span> <span class="s2">&quot;v5.2&quot;</span><span class="p">)</span>

<span class="c1"># scale capacity of solar plants in WA and AZ by 5 and 2.5, respectively</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">change_table</span><span class="o">.</span><span class="n">scale_plant_capacity</span><span class="p">(</span>
    <span class="s2">&quot;solar&quot;</span><span class="p">,</span> <span class="n">zone_name</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Washington&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Arizona&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">})</span>
<span class="c1"># scale capacity of wind farms in OR and MT by 1.5 and 2, respectively</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">change_table</span><span class="o">.</span><span class="n">scale_plant_capacity</span><span class="p">(</span>
    <span class="s2">&quot;wind&quot;</span><span class="p">,</span> <span class="n">zone_name</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Oregon&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s2">&quot;Montana Western&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="c1"># scale capacity of branches in NV and WY by 2</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">change_table</span><span class="o">.</span><span class="n">scale_branch_capacity</span><span class="p">(</span>
    <span class="n">zone_name</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Nevada&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Wyoming&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

<span class="c1"># add AC lines in NM and CO</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">change_table</span><span class="o">.</span><span class="n">add_branch</span><span class="p">(</span>
    <span class="p">[{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s2">&quot;from_bus_id&quot;</span><span class="p">:</span> <span class="mi">2053002</span><span class="p">,</span> <span class="s2">&quot;to_bus_id&quot;</span><span class="p">:</span> <span class="mi">2053303</span><span class="p">},</span>
     <span class="p">{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span> <span class="s2">&quot;from_bus_id&quot;</span><span class="p">:</span> <span class="mi">2060002</span><span class="p">,</span> <span class="s2">&quot;to_bus_id&quot;</span><span class="p">:</span> <span class="mi">2060046</span><span class="p">}])</span>

<span class="c1"># add DC line between CO and CA (Bay Area)</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">change_table</span><span class="o">.</span><span class="n">add_dcline</span><span class="p">(</span>
    <span class="p">[{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s2">&quot;from_bus_id&quot;</span><span class="p">:</span> <span class="mi">2060771</span><span class="p">,</span> <span class="s2">&quot;to_bus_id&quot;</span><span class="p">:</span> <span class="mi">2021598</span><span class="p">}])</span>

<span class="c1"># add a solar plant in NV, a coal plant in ID and a natural gas plant in OR</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">change_table</span><span class="o">.</span><span class="n">add_plant</span><span class="p">(</span>
    <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;solar&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_id&quot;</span><span class="p">:</span> <span class="mi">2030454</span><span class="p">,</span> <span class="s2">&quot;Pmax&quot;</span><span class="p">:</span> <span class="mi">75</span><span class="p">},</span>
     <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;coal&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_id&quot;</span><span class="p">:</span> <span class="mi">2074334</span><span class="p">,</span> <span class="s2">&quot;Pmin&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;Pmax&quot;</span><span class="p">:</span> <span class="mi">750</span><span class="p">,</span> <span class="s2">&quot;c0&quot;</span><span class="p">:</span> <span class="mi">1800</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span> <span class="mf">0.0025</span><span class="p">},</span>
     <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ng&quot;</span><span class="p">,</span> <span class="s2">&quot;bus_id&quot;</span><span class="p">:</span> <span class="mi">2090018</span><span class="p">,</span> <span class="s2">&quot;Pmax&quot;</span><span class="p">:</span> <span class="mi">75</span><span class="p">,</span> <span class="s2">&quot;c0&quot;</span><span class="p">:</span> <span class="mi">900</span><span class="p">,</span> <span class="s2">&quot;c1&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;c2&quot;</span><span class="p">:</span> <span class="mf">0.0015</span><span class="p">}])</span>

<span class="c1"># add a new bus, and a new one-way DC line connected to this bus</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">change_table</span><span class="o">.</span><span class="n">add_bus</span><span class="p">(</span>
	<span class="p">[{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="s2">&quot;zone_id&quot;</span><span class="p">:</span> <span class="mi">201</span><span class="p">,</span> <span class="s2">&quot;baseKV&quot;</span><span class="p">:</span> <span class="mi">138</span><span class="p">}])</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">change_table</span><span class="o">.</span><span class="n">add_dcline</span><span class="p">(</span>
	<span class="p">[{</span><span class="s2">&quot;from_bus_id&quot;</span><span class="p">:</span> <span class="mi">2090023</span><span class="p">,</span> <span class="s2">&quot;to_bus_id&quot;</span><span class="p">:</span> <span class="mi">20090024</span><span class="p">,</span> <span class="s2">&quot;Pmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Pmax&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}])</span>

<span class="c1"># get grid used in scenario</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_grid</span><span class="p">()</span>
<span class="c1"># get change table used to alter the base grid.</span>
<span class="n">ct</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_ct</span><span class="p">()</span>
</pre></div>
</div>
<p>It can be convenient to clear the change table when creating a scenario. Let’s say for instance that a wrong scaling factor has been applied or a generator has been attached to the wrong bus. To do so, the <code class="docutils literal notranslate"><span class="pre">clear</span></code> method of the <code class="docutils literal notranslate"><span class="pre">ChangeTable</span></code> class can be used.</p>
<p>There are also a couple of more advanced methods which can selectively scale branches based on the topology of the existing grid, or based on power flow results from a previous scenario. These can be called as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">change_table</span><span class="o">.</span><span class="n">scale_renewable_stubs</span><span class="p">()</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">change_table</span><span class="o">.</span><span class="n">scale_congested_mesh_branches</span><span class="p">(</span><span class="n">ref_scenario</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">ref_scenario</span></code> is a <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> object in <strong>analyze</strong> state.</p>
<p>The final step is to run the <code class="docutils literal notranslate"><span class="pre">create_scenario</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># review information</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">print_scenario_info</span><span class="p">()</span>
<span class="c1"># create scenario</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">create_scenario</span><span class="p">()</span>
<span class="c1"># print name of Scenario object state</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1"># print status of scenario</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">print_scenario_status</span><span class="p">()</span>
</pre></div>
</div>
<p>Once the scenario is successfully created, a scenario id is printed on screen and the state of the <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> object is switched to <strong>execute</strong>. printed on screen.</p>
</div>
<div class="section" id="c-running-the-scenario-and-extracting-output-data">
<h3>C. Running the Scenario and Extracting Output Data<a class="headerlink" href="#c-running-the-scenario-and-extracting-output-data" title="Permalink to this headline">¶</a></h3>
<p>It is possible to execute the scenario immediately right after it has been created. One can also create a new <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> object. This is the option we follow here.</p>
<p>The <strong>execute</strong> state accomplishes the three following tasks:</p>
<ul class="simple">
<li><p>It prepares the simulation inputs: the scaled profiles and the MAT-file enclosing all the information related to the electrical grid</p></li>
<li><p>It launches the simulation</p></li>
<li><p>It extracts the output data - This operation is performed once the simulation has finished running.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">powersimdata.scenario.scenario</span> <span class="kn">import</span> <span class="n">Scenario</span>

<span class="n">scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">(</span><span class="s2">&quot;dummy&quot;</span><span class="p">)</span>
<span class="c1"># print scenario information</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">print_scenario_info</span><span class="p">()</span>

<span class="c1"># prepare simulation inputs</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">prepare_simulation_input</span><span class="p">()</span>

<span class="c1"># launch simulation</span>
<span class="n">process_run</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">launch_simulation</span><span class="p">()</span>

<span class="c1"># Get simulation status</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">print_scenario_status</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that the status of the simulation can be accessed using the <code class="docutils literal notranslate"><span class="pre">print_scenario_status</span></code> method.</p>
<p>As an optional parameter, the number of threads used to run the simulation can be specified using for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">process_run</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">launch_simulation</span><span class="p">(</span><span class="n">threads</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<p>Extracting data from the simulation engine outputs can be a memory intensive process. If there are resource constraints where the engine resides, it is possible to pause the data from being extracted using an optional parameter and then manually extracting the data at a suitable time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">process_run</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">launch_simulation</span><span class="p">(</span><span class="n">extract_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># Extract data</span>
<span class="n">process_extract</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">extract_simulation_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="d-deleting-a-scenario">
<h3>D. Deleting a Scenario<a class="headerlink" href="#d-deleting-a-scenario" title="Permalink to this headline">¶</a></h3>
<p>A scenario can be deleted. All the input and output files as well as any entries in monitoring files will be removed. The <strong>delete</strong> state is only accessible from the <strong>analyze</strong> state.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">powersimdata.scenario.scenario</span> <span class="kn">import</span> <span class="n">Scenario</span>
<span class="kn">from</span> <span class="nn">powersimdata.scenario.delete</span> <span class="kn">import</span> <span class="n">Delete</span>

<span class="n">scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">(</span><span class="s2">&quot;dummy&quot;</span><span class="p">)</span>
<span class="c1"># print name of Scenario object state</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1"># print list of accessible states</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">allowed</span><span class="p">)</span>

<span class="c1"># switch state</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">change</span><span class="p">(</span><span class="n">Delete</span><span class="p">)</span>
<span class="c1"># print name of Scenario object state</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># delete scenario</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">delete_scenario</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="e-moving-a-scenario-to-backup-disk">
<h3>E. Moving a Scenario to Backup disk<a class="headerlink" href="#e-moving-a-scenario-to-backup-disk" title="Permalink to this headline">¶</a></h3>
<p>A scenario can be move to a backup disk. The <strong>move</strong> state is only accessible from the <strong>analyze</strong> state. The functionality is illustrated below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">powersimdata.scenario.scenario</span> <span class="kn">import</span> <span class="n">Scenario</span>
<span class="kn">from</span> <span class="nn">powersimdata.scenario.move</span> <span class="kn">import</span> <span class="n">Move</span>

<span class="n">scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">(</span><span class="s2">&quot;dummy&quot;</span><span class="p">)</span>
<span class="c1"># print name of Scenario object state</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1"># print list of accessible states</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">allowed</span><span class="p">)</span>

<span class="c1"># switch state</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">change</span><span class="p">(</span><span class="n">Move</span><span class="p">)</span>
<span class="c1"># print name of Scenario object state</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># move scenario</span>
<span class="n">scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">move_scenario</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="u-s-electric-grid-and-interconnection">
<h2>3. U.S. Electric Grid and Interconnection<a class="headerlink" href="#u-s-electric-grid-and-interconnection" title="Permalink to this headline">¶</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">Grid</span></code> object encapsulates all the information related to the synthetic network used in this project for a single interconnection (<strong>Eastern</strong>, <strong>Texas</strong> or <strong>Western</strong>), a combination of two interconnections (<strong>Eastern</strong> and <strong>Texas</strong> for example) or the full U.S. electric grid (<strong>USA</strong>). Only one argument is required to instantiate the <code class="docutils literal notranslate"><span class="pre">Grid</span></code> class, a <code class="docutils literal notranslate"><span class="pre">list</span></code> of interconnections (as <code class="docutils literal notranslate"><span class="pre">str</span></code>) in any order and a <code class="docutils literal notranslate"><span class="pre">str</span></code> for single interconnection or <strong>USA</strong>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">powersimdata.input.grid</span> <span class="kn">import</span> <span class="n">Grid</span>
<span class="n">western_texas</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">([</span><span class="s2">&quot;Western&quot;</span><span class="p">,</span> <span class="s2">&quot;Texas&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>The object has various attributes. These are listed below and a short description is given:</p>
<ul class="simple">
<li><p><strong>zone2id (id2zone)</strong>: <code class="docutils literal notranslate"><span class="pre">dict</span></code> – load zone name (load zone id) to load zone id (load zone name).</p></li>
<li><p><strong>interconnect</strong>: <code class="docutils literal notranslate"><span class="pre">str</span></code> –  interconnection name.</p></li>
<li><p><strong>bus</strong>: <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> – bus id as index and bus characteristics as columns.</p></li>
<li><p><strong>sub</strong>: <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> – substation id as index and substation information as columns.</p></li>
<li><p><strong>bus2sub</strong>: <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> – bus id as index and substation id as column.</p></li>
<li><p><strong>plant</strong>: <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> – plant id as index and plant characteristics as columns.</p></li>
<li><p><strong>branch</strong>: <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> – branch id as index and branch characteristics as columns.</p></li>
<li><p><strong>gencost</strong>: <code class="docutils literal notranslate"><span class="pre">dict</span></code> – has two keys: <code class="docutils literal notranslate"><span class="pre">before</span></code> and <code class="docutils literal notranslate"><span class="pre">after</span></code>. Values are <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> with plant id as index and generator cost curve information as columns. The <code class="docutils literal notranslate"><span class="pre">before</span></code> key points to the original set of cost curves (polynomials) whereas the <code class="docutils literal notranslate"><span class="pre">after</span></code> key gives the ones that has been used in the simulation (linearized or piece-wise linearized version).</p></li>
<li><p><strong>dcline</strong>: <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> – DC line id as index and DC line characteristics as columns.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">powersimdata.input.grid</span> <span class="kn">import</span> <span class="n">Grid</span>
<span class="n">usa</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span><span class="s2">&quot;USA&quot;</span><span class="p">)</span>
<span class="n">usa</span><span class="o">.</span><span class="n">plant</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># get all wind farm in the U.S. electrical grid</span>
<span class="n">wind_farm</span> <span class="o">=</span> <span class="n">usa</span><span class="o">.</span><span class="n">plant</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s2">&quot;wind&quot;</span><span class="p">)</span>
<span class="c1"># get DC lines in the grid</span>
<span class="n">dcline</span> <span class="o">=</span> <span class="n">usa</span><span class="o">.</span><span class="n">dcline</span>
</pre></div>
</div>
<p>The synthetic U.S. network used in our simulation framework can be found at the following url: <a class="reference external" href="https://electricgrids.engr.tamu.edu">https://electricgrids.engr.tamu.edu</a>. Our team has altered the original network in many ways to make it more realistic. These have been achieved by comparing our simulation results with historical generation level. Our data along with their description can be found on <a class="reference external" href="https://zenodo.org/record/3530898">zenodo</a>.</p>
</div>
<div class="section" id="capacity-planning-framework">
<h2>4. Capacity Planning Framework<a class="headerlink" href="#capacity-planning-framework" title="Permalink to this headline">¶</a></h2>
<p>The capacity planning framework is intended to estimate the amount of new capacity that will be required to meet future clean energy goals.</p>
<div class="section" id="a-required-inputs">
<h3>A. Required Inputs<a class="headerlink" href="#a-required-inputs" title="Permalink to this headline">¶</a></h3>
<p>At minimum, this framework requires a <em>reference</em> <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> object–used to specify the current capacities and capacity factors of resources which <em>count</em> towards state-level clean energy goals (this <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> object must be in <strong>analyze</strong> state)–and a list of target areas (comprised of one or more zones) and their target clean energy penetrations. A strategy must also be specified, either <code class="docutils literal notranslate"><span class="pre">independent</span></code> (each area meets it own goal) or <code class="docutils literal notranslate"><span class="pre">collaborative</span></code> (all areas with non-zero goals work together to meet a shared goal, resembling REC trading).</p>
<p>The list of targets may be specified in either a CSV file or a data frame, as long as the required columns are present: <code class="docutils literal notranslate"><span class="pre">region_name</span></code> and <code class="docutils literal notranslate"><span class="pre">ce_target_fraction</span></code>. Optional columns are: <code class="docutils literal notranslate"><span class="pre">allowed_resources</span></code> (defaulting to solar &amp; wind), <code class="docutils literal notranslate"><span class="pre">external_ce_addl_historical_amount</span></code> (clean energy not modeled in our grid, defaulting to 0), and <code class="docutils literal notranslate"><span class="pre">solar_percentage</span></code> (how much of the new capacity will be solar, defaulting to the current solar:wind ratio. This input only applies to the <em>independent</em> strategy, a shared-goal new solar fraction for <em>collaborative</em> planning is specified in the function call to <code class="docutils literal notranslate"><span class="pre">calculate_clean_capacity_scaling</span></code>.</p>
</div>
<div class="section" id="b-optional-inputs">
<h3>B. Optional Inputs<a class="headerlink" href="#b-optional-inputs" title="Permalink to this headline">¶</a></h3>
<p>Since increasing penetration of renewable capacity is often associated with increased curtailment, an expectation of this new curtailment can be passed as the <code class="docutils literal notranslate"><span class="pre">addl_curtailment</span></code> parameter. For the <em>collaborative</em> method, this must be passed as a dictionary of <code class="docutils literal notranslate"><span class="pre">{resource_name:</span> <span class="pre">value}</span></code> pairs, for the <em>independent</em> method this must be passed as a data frame or as a two-layer nested dictionary which can be interpreted as a data frame. For either method, additional curtailment must be a value between 0 and 1, representing a percentage, not percentage points. For example, if the previous capacity factor was 30%, and additional curtailment of 10% is specified, the expected new capacity factor will be 27%, not 20%.</p>
<p>Another <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> object can be passed as <code class="docutils literal notranslate"><span class="pre">next_scenario</span></code> to specify the magnitude of future demand (relevant for energy goals which are expressed as a fraction of total consumption); this <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> object may be any state, as long as <code class="docutils literal notranslate"><span class="pre">Scenario.state.get_demand()</span></code> can be called successfully, i.e. if the <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> object is in <strong>create</strong> state, an interconnection must be defined. This allows calculation of new capacity for a scenario which is being designed, using the demand scaling present in the change table.</p>
<p>Finally, for the <em>collaborative</em> method, a <code class="docutils literal notranslate"><span class="pre">solar_fraction</span></code> may be defined, which determines scenario-wide how much of the new capacity should be solar (the remainder will be wind).</p>
</div>
<div class="section" id="c-example-capacity-planning-function-calls">
<h3>C. Example Capacity Planning Function Calls<a class="headerlink" href="#c-example-capacity-planning-function-calls" title="Permalink to this headline">¶</a></h3>
<p>Basic independent call, using the demand from the reference scenario to approximate the future demand:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">powersimdata.design.generation.clean_capacity_scaling</span> <span class="kn">import</span> <span class="n">calculate_clean_capacity_scaling</span>
<span class="kn">from</span> <span class="nn">powersimdata.scenario.scenario</span> <span class="kn">import</span> <span class="n">Scenario</span>

<span class="n">ref_scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">(</span><span class="mi">403</span><span class="p">)</span>
<span class="n">targets_and_new_capacities_df</span> <span class="o">=</span> <span class="n">calculate_clean_capacity_scaling</span><span class="p">(</span>
    <span class="n">ref_scenario</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;independent&quot;</span><span class="p">,</span>
    <span class="n">targets_filename</span><span class="o">=</span><span class="s2">&quot;eastern_2030_clean_energy_targets.csv&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Complex collaborative call, using all optional parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">powersimdata.design.generation.clean_capacity_scaling</span> <span class="kn">import</span> <span class="n">calculate_clean_capacity_scaling</span>
<span class="kn">from</span> <span class="nn">powersimdata.scenario.scenario</span> <span class="kn">import</span> <span class="n">Scenario</span>

<span class="n">ref_scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">(</span><span class="mi">403</span><span class="p">)</span>
<span class="c1"># Start building a new scenario, to plan capacity for greater demand</span>
<span class="n">new_scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">new_scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">set_builder</span><span class="p">([</span><span class="s2">&quot;Eastern&quot;</span><span class="p">])</span>
<span class="n">zone_demand_scaling</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Massachusetts&quot;</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">,</span> <span class="s2">&quot;New York City&quot;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">}</span>
<span class="n">new_scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">change_table</span><span class="o">.</span><span class="n">scale_demand</span><span class="p">(</span><span class="n">zone_name</span><span class="o">=</span><span class="n">zone_demand_scaling</span><span class="p">)</span>
<span class="c1"># Define additional expected curtailment</span>
<span class="n">addl_curtailment</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;solar&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;wind&quot;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">}</span>

<span class="n">targets_and_new_capacities_df</span> <span class="o">=</span> <span class="n">calculate_clean_capacity_scaling</span><span class="p">(</span>
  <span class="n">ref_scenario</span><span class="p">,</span>
  <span class="n">method</span><span class="o">=</span><span class="s2">&quot;collaborative&quot;</span><span class="p">,</span>
  <span class="n">targets_filename</span><span class="o">=</span><span class="s2">&quot;eastern_2030_clean_energy_targets.csv&quot;</span><span class="p">,</span>
  <span class="n">addl_curtailment</span><span class="o">=</span><span class="n">addl_curtailment</span><span class="p">,</span>
  <span class="n">next_scenario</span><span class="o">=</span><span class="n">new_scenario</span><span class="p">,</span>
  <span class="n">solar_fraction</span><span class="o">=</span><span class="mf">0.55</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="d-creating-a-change-table-from-capacity-planning-results">
<h3>D. Creating a Change Table from Capacity Planning Results<a class="headerlink" href="#d-creating-a-change-table-from-capacity-planning-results" title="Permalink to this headline">¶</a></h3>
<p>The capacity planning framework returns a data frame of capacities by resource type and target area, but the Scenario creation process ultimately requires scaling factors by resource type and zone or plant_id. A function <code class="docutils literal notranslate"><span class="pre">create_change_table</span></code> exists to perform this conversion process. Using a reference scenario, a set of scaling factors by resource type, zone, and plant_id is calculated. When applied to a base <code class="docutils literal notranslate"><span class="pre">Grid</span></code> object, these scaling factors will result in capacities that are nearly identical to the reference scenario on a per-plant basis (subject to rounding), with the exception of solar and wind generators, which will be scaled up to meet clean energy goals.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">powersimdata.design.generation.clean_capacity_scaling</span> <span class="kn">import</span> <span class="n">create_change_table</span>

<span class="n">change_table</span> <span class="o">=</span> <span class="n">create_change_table</span><span class="p">(</span><span class="n">targets_and_new_capacities_df</span><span class="p">,</span> <span class="n">ref_scenario</span><span class="p">)</span>
<span class="c1"># The change table method only accepts zone names, not zone IDs, so we have to translate</span>
<span class="n">id2zone</span> <span class="o">=</span> <span class="n">new_scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get_grid</span><span class="p">()</span><span class="o">.</span><span class="n">id2zone</span>
<span class="c1"># Plants can only be scaled one resource at a time, so we need to loop through</span>
<span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">change_table</span><span class="p">:</span>
	<span class="n">new_scenario</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">change_table</span><span class="o">.</span><span class="n">scale_plant_capacity</span><span class="p">(</span>
		<span class="n">resource</span><span class="o">=</span><span class="n">resource</span><span class="p">,</span>
		<span class="n">zone_name</span><span class="o">=</span><span class="p">{</span>
			<span class="n">id2zone</span><span class="p">[</span><span class="nb">id</span><span class="p">]:</span> <span class="n">value</span>
			<span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">change_table</span><span class="p">[</span><span class="n">resource</span><span class="p">][</span><span class="s2">&quot;zone_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
		<span class="p">},</span>
		<span class="n">plant_id</span><span class="o">=</span><span class="n">change_table</span><span class="p">[</span><span class="n">resource</span><span class="p">][</span><span class="s2">&quot;zone_name&quot;</span><span class="p">]</span>
	<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="analyzing-scenario-designs">
<h2>5. Analyzing Scenario Designs<a class="headerlink" href="#analyzing-scenario-designs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="a-analysis-of-transmission-upgrades">
<h3>A. Analysis of Transmission Upgrades<a class="headerlink" href="#a-analysis-of-transmission-upgrades" title="Permalink to this headline">¶</a></h3>
<div class="section" id="i-cumulative-upgrade-quantity">
<h4>I. Cumulative Upgrade Quantity<a class="headerlink" href="#i-cumulative-upgrade-quantity" title="Permalink to this headline">¶</a></h4>
<p>Using the change table of a scenario, the number of upgrades lines/transformers and their cumulative upgraded capacity (for transformers) and cumulative upgraded megawatt-miles (for lines) can be calculated with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">powersimdata</span><span class="o">.</span><span class="n">design</span><span class="o">.</span><span class="n">transmission</span><span class="o">.</span><span class="n">mwmiles</span><span class="o">.</span><span class="n">calculate_mw_miles</span><span class="p">(</span><span class="n">scenario</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">scenario</span></code> is a <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> instance.</p>
</div>
<div class="section" id="ii-classify-upgrades">
<h4>II. Classify Upgrades<a class="headerlink" href="#ii-classify-upgrades" title="Permalink to this headline">¶</a></h4>
<p>The upgraded branches can also be classified into either interstate or intrastate branches by calling:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">powersimdata</span><span class="o">.</span><span class="n">design</span><span class="o">.</span><span class="n">transmission</span><span class="o">.</span><span class="n">statelines</span><span class="o">.</span><span class="n">classify_interstate_intrastate</span><span class="p">(</span><span class="n">scenario</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">scenario</span></code> is a <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> instance.</p>
</div>
</div>
<div class="section" id="b-analysis-of-generation-upgrades">
<h3>B. Analysis of Generation Upgrades<a class="headerlink" href="#b-analysis-of-generation-upgrades" title="Permalink to this headline">¶</a></h3>
<div class="section" id="i-accessing-and-saving-relevant-supply-information">
<h4>I. Accessing and Saving Relevant Supply Information<a class="headerlink" href="#i-accessing-and-saving-relevant-supply-information" title="Permalink to this headline">¶</a></h4>
<p>Analyzing generator supply and cost curves requires the proper generator cost and plant information to be accessed from a Grid object. This data can be accessed using the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">supply_df</span> <span class="o">=</span> <span class="n">powersimdata</span><span class="o">.</span><span class="n">design</span><span class="o">.</span><span class="n">generation</span><span class="o">.</span><span class="n">cost_curves</span><span class="o">.</span><span class="n">get_supply_data</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">num_segments</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">grid</span></code> is a <code class="docutils literal notranslate"><span class="pre">Grid</span></code> object and <code class="docutils literal notranslate"><span class="pre">num_segments</span></code> is the number of linearized cost curve segments into which the provided quadratic cost curve should be split.</p>
<p>The above returns a data frame that contains information about each generator’s fuel type, quadratic cost curve, and linearized cost curve, as well as the interconnect and load zone to which the generator belongs. The above function can store the data frame as a CSV file if <code class="docutils literal notranslate"><span class="pre">save</span></code> is passed a valid file path and file name string in <code class="docutils literal notranslate"><span class="pre">get_supply_data</span></code>; by default, <code class="docutils literal notranslate"><span class="pre">save=None</span></code>. The <code class="docutils literal notranslate"><span class="pre">get_supply_data</span></code> function is used within many of the following supply and cost curve visualization and analysis functions.</p>
</div>
<div class="section" id="ii-visualizing-generator-supply-curves">
<h4>II. Visualizing Generator Supply Curves<a class="headerlink" href="#ii-visualizing-generator-supply-curves" title="Permalink to this headline">¶</a></h4>
<p>To obtain the supply curve for a particular fuel type and area, the following is used:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="p">,</span> <span class="n">F</span> <span class="o">=</span> <span class="n">powersimdata</span><span class="o">.</span><span class="n">design</span><span class="o">.</span><span class="n">generation</span><span class="o">.</span><span class="n">cost_curves</span><span class="o">.</span><span class="n">build_supply_curve</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">num_segments</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">grid</span></code> is a <code class="docutils literal notranslate"><span class="pre">Grid</span></code> object; <code class="docutils literal notranslate"><span class="pre">num_segments</span></code> is the number of linearized cost curve segments to create; <code class="docutils literal notranslate"><span class="pre">area</span></code> is a string describing an appropriate load zone, interconnect, or state; and <code class="docutils literal notranslate"><span class="pre">type</span></code> is a string describing an appropriate fuel type.</p>
<p>By default, the above function plots the created supply curve (plotting can be suppressed by including <code class="docutils literal notranslate"><span class="pre">plot=False</span></code> in <code class="docutils literal notranslate"><span class="pre">build_supply_curve</span></code>). <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">F</span></code>, the supply curve capacity and bid quantities, respectively, are also returned. This function also allows for the area type (e.g., load zone, state, and interconnect are different area types) to be specified. By default, the area type is inferred, though there are instances where specifying the area type can be useful (e.g., Texas can refer to both a state and an interconnect, though they are not the same thing). To specify the area type, <code class="docutils literal notranslate"><span class="pre">area_type</span></code> must be passed a valid area type string in <code class="docutils literal notranslate"><span class="pre">build_supply_curve</span></code>.</p>
</div>
<div class="section" id="iii-comparing-supply-curves">
<h4>III. Comparing Supply Curves<a class="headerlink" href="#iii-comparing-supply-curves" title="Permalink to this headline">¶</a></h4>
<p>When updating generator cost curve information, it can be useful to see the corresponding effect on the supply curve for a particular area and fuel type pair. Instead of only performing a visual inspection between the original and new supply curves, the maximum price difference between the two supply curves can be calculated. This metric, which is similar to the Kolmogorov-Smirnov test, serves as a goodness-of-fit test between the two supply curves, where a lower score is desired. This metric can be calculated as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">max_diff</span> <span class="o">=</span> <span class="n">powersimdata</span><span class="o">.</span><span class="n">design</span><span class="o">.</span><span class="n">generation</span><span class="o">.</span><span class="n">cost_curves</span><span class="o">.</span><span class="n">ks_test</span><span class="p">(</span><span class="n">P1</span><span class="p">,</span> <span class="n">F1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">F2</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">P1</span></code> and <code class="docutils literal notranslate"><span class="pre">P2</span></code> are lists containing supply curve capacity data and <code class="docutils literal notranslate"><span class="pre">F1</span></code> and <code class="docutils literal notranslate"><span class="pre">F2</span></code> are lists containing corresponding supply curve price data. These lists can be created using <code class="docutils literal notranslate"><span class="pre">build_supply_curve</span></code> or can be created manually.</p>
<p>It should be noted that the two supply curves must offer the same amount of capacity (i.e., <code class="docutils literal notranslate"><span class="pre">max(P1)</span> <span class="pre">=</span> <span class="pre">max(P2)</span></code>). By default, the above function plots the two supply curves overlaid on a single plot (plotting can be suppressed by including <code class="docutils literal notranslate"><span class="pre">plot=False</span></code> in <code class="docutils literal notranslate"><span class="pre">ks_test()</span></code>).</p>
</div>
<div class="section" id="iv-comparing-cost-curve-parameters">
<h4>IV. Comparing Cost Curve Parameters<a class="headerlink" href="#iv-comparing-cost-curve-parameters" title="Permalink to this headline">¶</a></h4>
<p>When designing generator cost curves, it can be instructive to visually compare the quadratic cost curve parameters for generators in a particular area and fuel type pair. The <code class="docutils literal notranslate"><span class="pre">c1</span></code> and <code class="docutils literal notranslate"><span class="pre">c2</span></code> parameters for a given area and fuel type can be compared in a plot using the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">powersimdata</span><span class="o">.</span><span class="n">design</span><span class="o">.</span><span class="n">generation</span><span class="o">.</span><span class="n">cost_curves</span><span class="o">.</span><span class="n">plot_c1_vs_c2</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">grid</span></code> is a <code class="docutils literal notranslate"><span class="pre">Grid</span></code> object; <code class="docutils literal notranslate"><span class="pre">area</span></code> is a string describing an appropriate load zone, interconnect, or state; and <code class="docutils literal notranslate"><span class="pre">type</span></code> is a string describing an appropriate fuel type.</p>
<p>This function features a zoom capability (enabled by including <code class="docutils literal notranslate"><span class="pre">zoom=True</span></code> in <code class="docutils literal notranslate"><span class="pre">plot_c1_vs_c2</span></code>) that filters out <code class="docutils literal notranslate"><span class="pre">c2</span></code> outliers to enable better visualization. <code class="docutils literal notranslate"><span class="pre">c2</span></code> outliers outside of a specified number of standard deviations (the default is <code class="docutils literal notranslate"><span class="pre">num_sd=3</span></code>) are filtered out. The desired number of standard deviations can be changed by defining <code class="docutils literal notranslate"><span class="pre">num_sd</span></code> in <code class="docutils literal notranslate"><span class="pre">plot_c1_vs_c2</span></code>. Similar to <code class="docutils literal notranslate"><span class="pre">build_supply_curve</span></code>, this function also provides users with the ability to specify a particular area type.</p>
</div>
<div class="section" id="v-comparing-generators-by-capacity-and-price">
<h4>V. Comparing Generators by Capacity and Price<a class="headerlink" href="#v-comparing-generators-by-capacity-and-price" title="Permalink to this headline">¶</a></h4>
<p>When designing generator cost curves, it can be useful to visually compare the capacity and price parameters for each generator in a specified area and fuel type pair. The generator capacity and price parameters for a given area and fuel type can be compared in a plot using the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">powersimdata</span><span class="o">.</span><span class="n">design</span><span class="o">.</span><span class="n">generation</span><span class="o">.</span><span class="n">cost_curves</span><span class="o">.</span><span class="n">plot_capacity_vs_price</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">num_segments</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">grid</span></code> is a <code class="docutils literal notranslate"><span class="pre">Grid</span></code> object; <code class="docutils literal notranslate"><span class="pre">num_segments</span></code> is the number of linearized cost curve segments to create; <code class="docutils literal notranslate"><span class="pre">area</span></code> is a string describing an appropriate load zone, interconnect, or state; and <code class="docutils literal notranslate"><span class="pre">type</span></code> is a string describing an appropriate fuel type.</p>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">build_supply_curve</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_c1_vs_c2</span></code>, this function also provides users with the ability to specify a particular area type.</p>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/img/BE_Sciences_RGB_Horizontal_Color.svg" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">Modeling a clean energy future for the United States</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=Breakthrough-Energy&repo=docs&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="user/installation_guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev/contribution_guide.html">Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="user/git_guide.html">Working with Git</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">PowerSimData</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setup-install">1. Setup/Install</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-using-pipenv">A. Using pipenv</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b-using-the-requirements-txt-file">B. Using the <em><strong>requirements.txt</strong></em> file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#c-path">C. Path</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#scenario-framework">2. Scenario Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-retrieving-scenario-output-data">A. Retrieving Scenario Output Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b-creating-a-scenario">B. Creating a Scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="#c-running-the-scenario-and-extracting-output-data">C. Running the Scenario and Extracting Output Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#d-deleting-a-scenario">D. Deleting a Scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="#e-moving-a-scenario-to-backup-disk">E. Moving a Scenario to Backup disk</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#u-s-electric-grid-and-interconnection">3. U.S. Electric Grid and Interconnection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#capacity-planning-framework">4. Capacity Planning Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-required-inputs">A. Required Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b-optional-inputs">B. Optional Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#c-example-capacity-planning-function-calls">C. Example Capacity Planning Function Calls</a></li>
<li class="toctree-l3"><a class="reference internal" href="#d-creating-a-change-table-from-capacity-planning-results">D. Creating a Change Table from Capacity Planning Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#analyzing-scenario-designs">5. Analyzing Scenario Designs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-analysis-of-transmission-upgrades">A. Analysis of Transmission Upgrades</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b-analysis-of-generation-upgrades">B. Analysis of Generation Upgrades</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="prereise_package.html">PreREISE</a></li>
<li class="toctree-l1"><a class="reference internal" href="postreise_package.html">PostREISE</a></li>
<li class="toctree-l1"><a class="reference internal" href="reisejl_package.html">REISE.jl</a></li>
</ul>

<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="user/git_guide.html" title="previous chapter">Working with Git</a></li>
      <li>Next: <a href="prereise_package.html" title="next chapter">PreREISE</a></li>
  </ul></li>
</ul><h3>Useful Links</h3>
<ul>
  <li><a href="https://www.breakthroughenergy.org/">Breakthrough Energy</a></li>
  <li><a href="https://science.breakthroughenergy.org/">Breakthrough Energy Sciences</a></li>
  <li><a href="https://arxiv.org/abs/2002.06155">publication</a></li>
  <li><a href="https://zenodo.org/record/3530898">data @ zenodo</a></li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><ul>
<h3>Code</h3>
<a href="py-modindex.html">Module Index</a>
</ul>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Breakthrough Energy Foundation.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/powersimdata_package.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>